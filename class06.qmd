---
title: "Class 6: R Functions"
author: "Garrett Cole"
format: pdf
---

## Function basics

-   A **name** (we can pick this but it must start with a character)
-   Input **arguments** (there can be multiple comma separated inputs)
-   The **body** (where work actually happens)

```{r}
# Example input vectors to start with
student1 <- c(100, 100, 100, 100, 100, 100, 100, 90) 
student2 <- c(100, NA, 90, 90, 90, 90, 97, 80) 
student3 <- c(90, NA, NA, NA, NA, NA, NA, NA)
```

## Q1 Create Function grades()

Removing the minimum value and using mean function

```{r}
mean(student1[-which.min(student1)])

mean(student2[-which.min(student2)])

mean(student3[-which.min(student3)])
```

Converting NA to 0

```{r}
student1[is.na(student1)] <- 0
student1

student2[is.na(student2)] <- 0
student2

student3[is.na(student3)] <- 0
student3
```

Find Grade By Combine NA \<- 0 & Remove Min

```{r}
student1[is.na(student1)] <- 0
mean(student1[-which.min(student1)])

student2[is.na(student2)] <- 0
mean(student2[-which.min(student2)])

student3[is.na(student3)] <- 0
mean(student3[-which.min(student3)])
```

I now have my working snippet of code that I have simplified to work with any student 'x'

```{r}
grade <- function(x) {
  #Convert all NA to 0
  x[is.na(x)] <- 0
  #Calculate average with lowest score dropped
  mean(x[-which.min(x)])
}
```

```{r}
grade(student1)
grade(student2)
grade(student3)
```

## Q2

Using your grade() function and the supplied gradebook, Who is the top scoring student overall in the gradebook?

```{r}
url <- "https://tinyurl.com/gradeinput"
gradebook <- read.csv(url, row.names = 1)

```

Grade all the students

```{r}
avgStudent <- apply(gradebook, 1, grade)
avgStudent
```

Which student has the highest grade?

```{r}
which.max(avgStudent)
```

Student 18 has the highest overall grade at 94.50

## Q3

From your analysis of the gradebook, which homework was toughest on students (i.e. obtained the lowest scores overall?

Find the average of each hw (each column)

```{r}
avgHW <- apply(gradebook, 2, grade)
which.min(avgHW)
```

HW 2 was the toughest on students

## Q4

From your analysis of the gradebook, which homework was most predictive of overall score(i.e. highest correlation with average grade score)?

```{r}
mask <- gradebook
mask[ is.na(mask) ] <- 0

cor(mask$hw1 , avgStudent)
cor(mask$hw2 , avgStudent)
cor(mask$hw3 , avgStudent)
cor(mask$hw4 , avgStudent)
cor(mask$hw5 , avgStudent)

apply(mask, 2, cor, y = avgStudent)
```

Homework 5 had the highest correlation with the average grade score making it the most predictive of overall score
